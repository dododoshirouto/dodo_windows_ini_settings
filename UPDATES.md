# UPDATES

## 2026-02-25 winget 一括インストールスクリプト実装

### 作業内容
- `winget_install.ps1` を新規作成
  - `winget-list.txt` を読み込んで1行1アプリを winget インストール
  - ID形式（`Git.Git`）と名前形式を自動判定
  - `--silent` でサイレントインストール
  - エラー時はスキップして続行
  - 最後にエラーアプリを一覧表示
  - ログファイル（`%TEMP%\winget_install_log.txt`）に記録
  - 管理者権限・winget存在・リストファイル存在チェックを追加
- `winget-list.txt` サンプルファイルを新規作成
- `README.md` に winget スクリプトの使い方を追記

---

## 2026-02-25 リファクタ実施


### 作業内容

`windows_ini_settings.ps1` を全面リファクタした。

#### バグ修正
- L89・L111のレジストリパスのコロン抜け（`HKCU\` → `HKCU:\`）を修正

#### 安全性強化
- 管理者権限チェックを冒頭に追加（未管理者なら即終了）
- Windowsバージョンチェックを追加（Windows 10/11 前提）
- スクリプト実行前に復元ポイント（`Checkpoint-Computer`）を自動作成
- `try/catch` によるエラーハンドリングを各設定処理に追加

#### 設定の外部化
- スクロール行数・電源プランGUID・ログパスなどを冒頭の `$Config` ブロックに集約
- ユーザーが触るパラメータを内部ロジックから分離

#### ログ機能追加
- `Write-Log` 関数を追加
- コンソール出力 + ログファイル（`%TEMP%\ini_settings_log.txt`）への二重出力

#### コード整理
- セクション番号の歯抜け（1-3→4→5→…→9→8→10→11→12）を1〜10に統一
- 汎用関数を `Set-OrNew-RegValue` → `Set-RegValue` にリネームし、`Test-Path` によるパス自動作成も追加
- 未使用のコメントアウトコードを削除

#### ドキュメント更新
- `README.md` に前提条件・ログパス・`$Config` の説明を追記
- `UPDATES.md` を新規作成

---

## 作業計画（今後）

- [ ] 仮想環境などでの動作テスト
- [ ] 必要に応じて設定項目の追加・削除
